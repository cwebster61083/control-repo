input { 
  file { 
    path => "/Users/chris.webster/clientlogs/puppetserver.log" start_position => "beginning"
    codec => multiline {
          # Grok pattern names are valid! :)
          pattern => "^%{TIMESTAMP_ISO8601} "
          negate => true
          what => "previous"
        }
  }
} 

filter { grok { match => { "message" => "%{TIMESTAMP_ISO8601:timestamp} %{LOGLEVEL:loglevel} (?<ID>\s\[.*?]|\[.*?]) (?<Source>\[.*?]) %{GREEDYDATA:message}" }}} 

output { 
  elasticsearch { 
    hosts => ["elastic.puppetdebug.vlan:9200"] 
  }
}
